# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.1.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

---

## [0.5.0] - 2026-02-13

### Added
- ✅ **코덱별 동적 화질 설정 시스템**: 인코더 종류(NVENC, QSV, AMF, Software 등)에 따라 화질 파라미터(CQ, ICQ, QP, CRF, qscale)와 범위를 자동 매핑 ✨
  - **VP9/AV1 지원**: 최신 코덱에 맞춰 0~63 범위 및 최적 권장값 적용
  - **MPEG-4 지원**: 레거시 코덱 호환성을 위한 1~31 qscale 범위 지원
- ✅ **상호작용형 화질 설정 UI**: '고화질', '권장', '저용량' 라벨을 클릭 가능한 버튼으로 전환하여 즉시 설정 가능 ✨
- ✅ **다이내믹 도움말 툴팁**: 선택한 코덱의 기술적 특징에 맞춰 실시간으로 내용이 변경되는 지능형 툴팁 적용 ✨
- ✅ **OS별 명령어 복사 이원화**: Windows CMD 전용(`^` 줄바꿈) 및 Unix/Shell 전용(`\` 줄바꿈) 복사 버튼 분리 제공 ✨
- ✅ **의존성 자동 관리 시스템**: `run.py` 실행 시 필요한 라이브러리를 자동 감지 및 설치하며, 로그를 간소화하여 편의성 향상 ✨

### Changed
- ✅ **명령어 미리보기 로직 개선**: 실행 환경(OS/Shell)에 맞는 줄바꿈 및 이스케이프 처리를 통해 복사 후 즉시 실행 가능한 신뢰도 향상
- ✅ **인코딩 시 시각적 피드백 강화**: 화질 설정 변경 시 현재 상태(초고화질/권장/저용량)를 더 명확하게 표시

### Fixed
- ✅ **Taskbar Progress 안정화**: 특정 환경에서 `comtypes` 라이브러리 부재 시 발생하던 오류를 예외 처리를 통해 방지
- ✅ **품질 슬라이더 범위 초기화**: 코덱 변경 시 기존 설정값이 새 코덱의 범위를 벗어날 경우 안전한 기본값으로 자동 보정

---

## [0.4.0] - 2026-02-12

### Added
- ✅ **메타데이터 분석 엔진 통합 및 고도화**: `metadata_utils.py`로 로직을 통합하여 검색과 인코딩 시 동일한 고성능 분석 엔진 사용 ✨
- ✅ **비정상 메타데이터 감지 및 필터링**: 파일 헤더가 손상되어 재생 시간이 부정확한 파일을 자동으로 감지하고 '상태' 컬럼에 표시 ✨
  - **비정상 파일 필터**: 검색 결과에서 메타데이터 보정이 필요한 파일만 따로 모아볼 수 있는 필터 추가
- ✅ **해상도 및 재생 시간 정렬 개선**: 픽셀 수 기반의 지능형 해상도 정렬 및 초 단위 정밀 재생 시간 정렬 지원 ✨
- ✅ **메타데이터 추출 상태 가시화**: 상태 표시줄과 텍스트 정보를 통해 1단계(빠른 스캔) 및 2단계(정밀 분석) 진행 상황 실시간 표시 ✨

### Changed
- ✅ **UI 레이아웃 개선**: 탭 버튼 크기 확대 및 스타일 개선으로 터치/클릭 편의성 향상
- ✅ **내부 아키텍처 리팩토링**: `searcher.py`와 `encoder.py`에 분산되어 있던 분석 로직을 `metadata_utils.py`로 단일화하여 유지보수성 향상

### Technical Details
- 새 모듈: `src/renqoder/metadata_utils.py` - 통합 메타데이터 엔진
- FFmpeg-based Stage 2 스캔 알고리즘 개선: 손상된 인덱스를 가진 TS/MP4 파일 분석 신뢰도 향상

---

## [0.3.0] - 2026-02-08

### Added
- ✅ **동영상 파일 검색 기능 고도화**: Everything 연동 초고속 검색 및 지능형 메타데이터 분석 시스템 ✨
  - Everything CLI (es.exe) 자동 감지 및 초고속 검색 통합
  - **드라이브 카드 UI**: 직관적인 카드 스타일로 드라이브 선택, 용량 정보 및 사용률 표시
  - **2단계 메타데이터 분석**: 빠른 스캔(Stage 1) + 정밀 스캔(Stage 2)으로 Streamlink 녹화 파일 등 미완성 파일의 재생시간도 정확히 감지
  - **메타데이터 캐시 시스템**: 한 번 분석한 파일 정보를 저장하여 재검색 시 즉시 표시 (SHA-256 해시 기반 프라이버시 보호)
  - `ffprobe`를 이용한 백그라운드 메타데이터(코덱, 해상도, FPS, 비트레이트, 재생시간) 추출
  - **컨텍스트 메뉴 (우클릭)**: 폴더 열기, 경로/파일명 복사, 캐시 재분석, 휴지통으로 삭제
  - **키보드 단축키**: Home/End 키로 첫/마지막 항목 이동, 더블클릭으로 인코딩 탭 전송
  - 검색 결과 실시간 필터링 (컨테이너, 코덱, 파일 크기, 비트레이트)
  - 컬럼 헤더 클릭을 통한 검색 결과 정렬 기능 (오름차순/내림차순 토글)
  - 검색 결과에서 파일을 선택하여 즉시 인코딩 탭으로 전송하는 워크플로우 지원
- ✅ **탭 기반 UI 리팩토링**: 인코딩과 검색 기능을 별도 탭으로 분리하여 워크플로우 개선 ✨
- ✅ **인코딩 완료 시 OS 알림 표시**: Windows 10/11 Toast 알림으로 인코딩 완료 및 용량 절감 정보를 실시간으로 알림 ✨
- ✅ **개발 모드 자동 감지**: `sys.frozen` 속성을 활용하여 개발/배포 환경을 자동으로 구분 ✨
- ✅ **알림 테스트 버튼**: 개발 모드에서만 표시되는 알림 테스트 기능 추가 (배포 버전에서는 숨김) ✨
- ✅ **인코딩 예상 남은 시간 표시**: FFmpeg의 인코딩 속도(speed)를 분석하여 실시간으로 예상 완료 시간을 계산하여 표시 ✨
- ✅ **UI 레이아웃 대폭 간소화**: 불필요한 라벨들을 제거하고 진행 상황을 버튼으로 통합 ✨
- ✅ **멀티라인 진행 상황 표시**: START 버튼 내에 진행 퍼센트와 남은 시간을 두 줄로 표시하여 시인성 향상 ✨
- ✅ **프로그래스바 위치 최적화**: 실행 버튼 아래로 배치하여 작업의 수직 흐름을 자연스럽게 개선 ✨
- ✅ **UI 레이아웃 최적화**: 출력 드라이브 용량 표기를 '예상 결과 용량' 섹션으로 이동하여 가독성 향상 ✨
- ✅ **드라이브 용량 경고 로직 개선**: 절대량 기준 대신 예상 용량의 **125% 미만**일 때 경고를 표시하도록 지능화 ✨
- ✅ **진행률 표시 방식 개선**: 인코딩 중 진행 퍼센트(%)를 START 버튼 라벨에 직접 표시하여 시각적 직관성 강화 ✨
- 인코딩 시 출력 컨테이너를 항상 `.mp4`로 강제하도록 수정 (호환성 향상)
- ✅ **입력 파일 필터 목록 대폭 확장**: `.ts`, `.m2ts`, `.wmv`, `.flv`, `.webm`, `.vob`, `.3gp`, `.m4v` 등 다양한 비디오 포맷 지원 ✨
- ✅ 파일 선택창 가독성 개선 (필터 목록 멀티라인 처리) ✨
- ✅ **빌드 스크립트 개선**: 배포용 `.exe` 파일 이름에 버전 정보를 자동으로 포함하도록 개선 (`renQoder-v0.3.0.exe`) ✨
- ✅ **버전 관리 자동화**: `__init__.py`의 버전 정보를 빌드 스크립트에서 동적으로 참조하도록 구현 ✨
- ✅ **윈도우 타이틀에 버전 표시**: 앱 윈도우 타이틀에 현재 버전 정보를 표시하여 사용자가 실행 중인 버전을 쉽게 확인 가능 ✨

### Fixed
- ✅ 특정 환경에서 파일 선택 시 `.ts` 파일이 보이지 않던 문제 해결
- ✅ `win10toast` 라이브러리의 WNDPROC 에러 메시지 처리 개선

### Technical Details
- 새 모듈: `src/renqoder/searcher.py` - VideoSearcher 클래스
- Everything CLI stdout 파싱 (임시 파일 생성 없음)
- 백그라운드 스레드 기반 논블로킹 검색

### Dependencies
- `win10toast`: Windows 10/11 Toast 알림 표시를 위한 라이브러리 추가

## [0.2.0] - 2026-02-07

### Added
- ✅ **안전한 덮어쓰기 (휴지통 이동)**: 덮어 쓰기 시 기존 파일을 휴지통으로 이동하여 복구 가능 ✨
- ✅ 화질 조정 슬라이더 개선 및 도움말 툴팁 추가 ✨
- ✅ 오디오 설정 UI 개선 (라디오 버튼 및 툴팁 추가) ✨
- ✅ 드라이브 남은 용량 실시간 표시 (출력 경로 기준) ✨
- ✅ 마지막 윈도우 위치 및 크기 기억/복원 기능 ✨
- ✅ 윈도우 오프스크린 폴백 처리 (모니터 구성 변경 대응) ✨
- ✅ **인코딩 진행률 및 퍼센트(%) 실시간 표시** ✨
- ✅ FFmpeg 명령어 미리보기 및 **"한 줄로 복사"** 기능 ✨
- ✅ **SCTE-35 방송 트랙** 대응 (-map 0:v -map 0:a 강제) ✨
- 🤖 **AI 기여 및 아이콘 제작 명시 추가** (README.md)

### Fixed
- ✅ 오디오 코덱 자동 감지 오류 수정
- ✅ 오디오 카피 모드에서 실제 스트림 크기 측정으로 정확도 향상
- ✅ 리소스 경로 인식 로직 개선 (Standalone 대응)
- ✅ 재생 시간 및 FPS 감지 신뢰도 향상

### Technical Details
- **Language**: Python 3.10+
- **GUI Framework**: CustomTkinter (MIT)
- **Video Encoder**: FFmpeg
- **Build Tool**: PyInstaller

---

## [0.1.0] - 2026-02-07

### Added
- 🎉 **Initial PoC Release** (Commit: `cdee02a`)
- ✅ 자동 GPU 감지 (NVIDIA/AMD/Intel)
- ✅ 최적 하드웨어 인코더 자동 선택 (NVENC/QSV/AMF)
- ✅ FFmpeg 설치 확인 및 다운로드 안내
- ✅ **CustomTkinter 기반 모던 다크 테마 GUI (MIT 라이선스)**
- ✅ 오디오 모드 선택 (Copy/AAC)
- ✅ 스마트 출력 파일명 자동 생성 (코덱, 품질, 오디오 코덱 정보 포함)
- ✅ 오디오 코덱 자동 감지 및 실시간 반영
- ✅ 백그라운드 인코딩 프로세스 (threading 사용)
- ✅ 마지막 사용 폴더 기억 기능
- ✅ 출력 파일명 수동 수정 기능
- ✅ PyInstaller 기반 Standalone 빌드 지원
- 📁 체계적인 프로젝트 구조 및 문서화

---

## [Unreleased]

### Planned for v0.5
- [ ] 배치 처리 기능
- [ ] 드래그 앤 드롭 지원

### Planned for v1.0
- [ ] 예상 파일 크기 계산
- [ ] 설정 저장/불러오기
- [ ] macOS 지원
- [ ] 프리셋 시스템

### Planned for v1.5
- [ ] Linux 지원
- [ ] 크로스 플랫폼 빌드 시스템

### Planned for v2.0
- [ ] Watch Folder 기능
- [ ] 멀티 GPU 지원

---

## Version History

- **v0.5.0** (2026-02-13): 코덱별 동적 화질 설정, 상호작용 UI 및 OS별 명령어 복사 지원
- **v0.4.0** (2026-02-12): 메타데이터 분석 엔진 통합, 비정상 파일 필터 및 정렬 기능 고도화
- **v0.3.0** (2026-02-08): 남은 시간 표시, UI 레이아웃 최적화 및 입력 필터 확장
- **v0.2.0** (2026-02-07): 안전한 덮러쓰기(휴지통), UI/UX 개선 및 버그 수정
- **v0.1.0** (2026-02-07): Initial PoC Release - 핵심 인코딩 엔진 및 GUI 기반 마련
